// Alternative Alloy configuration using environment variables (for secrets)
// Use this if you want to store credentials in Fly.io secrets instead of hardcoding

// Loki write component - forwards logs to Grafana Cloud
loki.write "grafana_cloud_loki" {
  endpoint {
    url = env("LOKI_ENDPOINT")
    basic_auth {
      username = env("LOKI_USERNAME")
      password = env("LOKI_PASSWORD")
    }
  }
}

// HTTP server for receiving logs from the license server
loki.source.http "license_server" {
  server {
    http_listen_port = 3100
    grpc_listen_port = 9096
  }

  forward_to = [loki.write.grafana_cloud_loki.receiver]
  
  labels = {
    source = "flyio",
  }
}

